### next() vs return next()

---

<br>

`Using next()`: If you have any middleware function and below the next() you have some lines or function that you want to execute, then by using next() you can actually execute the lines or function because it runs the code below next() after all middleware function finished.

`Using return next()`: If you have any middleware function and below the return next() you have some lines that you want to execute, then the lines which are below return next() wonâ€™t be executed because it will jump out the callback immediately and the code below return next() in the callback will be unreachable.

<br>

```js
app.use((req, res, next) => {
  console.log("Calling first middleware");
  next();
});
```

<Br>

express middlewareì•ˆì—ì„œ next()ë¥¼ ì´ìš©í•´ ì œì–´ë¥¼ ë„˜ê¸°ë©´ ëì´ë¼ê³  ìƒê°í–ˆì—ˆë‹¤.

<Br>

### ğŸ¤·â€â™€ï¸ ìœ„ ì½”ë“œëŠ” next()ë’¤ì— ì•„ë¬´ëŸ° ì½”ë“œê°€ ì—†ìœ¼ë‹ˆ ìƒê´€ì—†ì§€ë§Œ, ë§Œì•½ ë‹¤ë¥¸ ë™ì‘ì´ ì´ì–´ì§„ë‹¤ë©´ ì–´ë–¨ê¹Œ?

<br>

```js
import express from "express";

const app = express();
app.use(express.json());

// 1ë²ˆ
app.use((req, res, next) => {
  console.log("Calling first middleware");
  next();
  console.log("Calling after the next() function");
});

// 2ë²ˆ
app.use((req, res, next) => {
  console.log("Calling second middleware");
  return next(); // It returns the function block immediately and call next() function so the return next(); and next(); return; are the same
  console.log("After calling return next()");
});

app.listen(8080);
```

<br>

### âœ¨ ê²°ê³¼

<br>

    Calling first middleware
    Calling second middleware
    Calling after the next() function

<br>

1ë²ˆì—ì„œ next()ë¥¼ ì´ìš©í•´
2ë²ˆìœ¼ë¡œ ê°”ì§€ë§Œ, 2ë²ˆì´ ëë‚œë‹¤ìŒì— ë‹¤ì‹œ 1ë²ˆì´ ëë‚¬ë˜ ì‹œì ìœ¼ë¡œ ëŒì•„ì™€ì„œ
ë‚˜ë¨¸ì§€ ë¡œì§ì„ ìˆ˜í–‰í•˜ëŠ” ê±¸ ë³¼ ìˆ˜ ìˆë‹¤. ì œì–´ê°€ ë‹¤ì‹œ ëŒì•„ì˜¨ë‹¤.
ì´ëŸ¬ë©´ responseê°€ ì¤‘ë³µë˜ê±°ë‚˜ ë˜ëŠ” ë‹¤ë¥¸ ì˜¤ë¥˜ê°€ ë°œìƒí•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ë§¤ìš° ì¢‹ì§€ì•Šë‹¤.

í•˜ì§€ë§Œ 2ë²ˆì„ ë³´ë©´ next()ë’¤ì— ë¡œì§ì´ ìˆì§€ë§Œ, return next()ì™€ ê°™ì´ ì‘ì„±í•œ ë•ë¶„ì—
console.log("After calling return next()"); ì—ëŠ” ë„ë‹¬í•˜ì§€ ì•Šì•˜ë‹¤.

ë”°ë¼ì„œ í•´ë‹¹ middlewareì˜ ë™ì‘ì„ ëë‚´ê³  ì‹¶ìœ¼ë©´ ë‹¤ìŒê³¼ ê°™ì´ returnì„ ë¶™ì´ì.

<Br>

### ğŸ“Œ next('route')

<br>

ë¼ìš°íŠ¸ í•¸ë“¤ëŸ¬ë¥¼ ì´ìš©í•˜ë©´ í•˜ë‚˜ì˜ ê²½ë¡œì— ëŒ€í•´ ì—¬ëŸ¬ ë¼ìš°íŠ¸ë¥¼ ì •ì˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì•„ë˜ì˜ ì˜ˆì—ì„œëŠ” /user/:id ê²½ë¡œì— ëŒ€í•œ GET ìš”ì²­ì— ëŒ€í•´ 2ê°œì˜ ë¼ìš°íŠ¸ë¥¼ ì •ì˜í•©ë‹ˆë‹¤. ë‘ ë²ˆì§¸ ë¼ìš°íŠ¸ëŠ” ì–´ë– í•œ ë¬¸ì œë„ ë°œìƒí•˜ì§€ ì•Šì§€ë§Œ, ì²« ë²ˆì§¸ ë¼ìš°íŠ¸ê°€ ìš”ì²­-ì‘ë‹µ ì£¼ê¸°ë¥¼ ì¢…ë£Œì‹œí‚¤ë¯€ë¡œ ë‘ ë²ˆì§¸ ë¼ìš°íŠ¸ëŠ” ì ˆëŒ€ë¡œ í˜¸ì¶œë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

ë‹¤ìŒ ì˜ˆì—ëŠ” /user/:id ê²½ë¡œì— ëŒ€í•œ GET ìš”ì²­ì„ ì²˜ë¦¬í•˜ëŠ” ë¯¸ë“¤ì›¨ì–´ í•˜ìœ„ ìŠ¤íƒì´ í‘œì‹œë˜ì–´ ìˆìŠµë‹ˆë‹¤.

<br>

```js
app.get(
  "/user/:id",
  function (req, res, next) {
    console.log("ID:", req.params.id);
    next();
  },
  function (req, res, next) {
    res.send("User Info");
  }
);

// handler for the /user/:id path, which prints the user ID
app.get("/user/:id", function (req, res, next) {
  res.end(req.params.id);
});
```

<Br>

ë¼ìš°í„° ë¯¸ë“¤ì›¨ì–´ ìŠ¤íƒì˜ ë‚˜ë¨¸ì§€ ë¯¸ë“¤ì›¨ì–´ í•¨ìˆ˜ë“¤ì„ ê±´ë„ˆë›°ë ¤ë©´ next('route')ë¥¼ í˜¸ì¶œí•˜ì—¬ ì œì–´ë¥¼ ê·¸ ë‹¤ìŒ ë¼ìš°íŠ¸ë¡œ ì „ë‹¬í•˜ì‹­ì‹œì˜¤.

`ì°¸ê³ : next('route')ëŠ” app.METHOD() ë˜ëŠ” router.METHOD() í•¨ìˆ˜ë¥¼ ì´ìš©í•´ ë¡œë“œëœ ë¯¸ë“¤ì›¨ì–´ í•¨ìˆ˜ì—ì„œë§Œ ì‘ë™í•©ë‹ˆë‹¤.`

ë‹¤ìŒ ì˜ˆì—ëŠ” /user/:id ê²½ë¡œì— ëŒ€í•œ GET ìš”ì²­ì„ ì²˜ë¦¬í•˜ëŠ” ë¯¸ë“¤ì›¨ì–´ í•˜ìœ„ ìŠ¤íƒì´ í‘œì‹œë˜ì–´ ìˆìŠµë‹ˆë‹¤.

```js
app.get(
  "/user/:id",
  function (req, res, next) {
    // if the user ID is 0, skip to the next route
    if (req.params.id == 0) next("route");
    // otherwise pass the control to the next middleware function in this stack
    else next(); //
  },
  function (req, res, next) {
    // render a regular page
    res.render("regular");
  }
);

// handler for the /user/:id path, which renders a special page
app.get("/user/:id", function (req, res, next) {
  res.render("special");
});
```
